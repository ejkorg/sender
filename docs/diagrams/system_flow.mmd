flowchart LR
  subgraph User_Devices
    Browser["Browser / Angular SPA"]
  end

  subgraph Frontend
  Browser -->|"HTTP REST (POST /api/senders/{id}/enqueue, GET /api/senders/{id}/queue)"| FrontendApp["Angular SPA"]
  end

  subgraph Backend
    BackendLabel["Spring Boot"]
    API["REST API - SenderController, ExternalLocationController"]
    Services["Services - SenderService, MetadataImporterService, ExternalLocationService, MailService"]
    Repos["Repositories - SenderQueueRepository, ExternalMetadataRepository, ExternalLocationRepository, ExternalEnvironmentRepository"]
    Scheduler["Scheduler - DiscoveryScheduler"]
  end

  BackendLabel --> API
  API --> Services
  Services --> Repos
  Repos --> Scheduler

  subgraph Datastores
    AppDB[("Application DB - contains sender_queue, metadata, locations")]
    ExternalDBs[("External Data Sources - configured via dbconnections.json")]
  end

  SMTP["Mail / SMTP"]
  CI["CI/CD / Build -> Maven"]

  FrontendApp -->|"REST JSON"| API
  Services -->|"connect to"| ExternalDBs
  Services -->|"send email"| SMTP
  CI -->|"build & deploy"| BackendLabel

  classDef infra fill:#f9f,stroke:#333,stroke-width:1px;
  class ExternalDBs,AppDB,SMTP,CI infra

  style Backend fill:#f2f8ff,stroke:#0366d6
  style Frontend fill:#fff4e6,stroke:#d97706
  style Datastores fill:#f3f4f6
